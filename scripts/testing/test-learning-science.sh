#!/bin/bash

# InspireEd 学习科学优化 - 功能测试启动脚本
# 用途：快速启动前端服务并提供测试指引
# 日期：2025-11-04

echo "╔══════════════════════════════════════════════════════════╗"
echo "║   🎓 InspireEd 学习科学优化 - 功能测试启动              ║"
echo "╚══════════════════════════════════════════════════════════╝"
echo ""

# 检查是否在项目根目录
if [ ! -d "frontend" ] || [ ! -d "backend" ]; then
    echo "❌ 错误：请在项目根目录运行此脚本"
    exit 1
fi

echo "📋 检查环境..."
echo ""

# 检查 pnpm 是否安装
if ! command -v pnpm &> /dev/null; then
    echo "⚠️  警告：pnpm 未安装，尝试使用 npm..."
    NPM_CMD="npm"
else
    NPM_CMD="pnpm"
    echo "✅ pnpm 已安装"
fi

# 检查前端依赖
if [ ! -d "frontend/node_modules" ]; then
    echo "📦 安装前端依赖..."
    cd frontend
    $NPM_CMD install
    cd ..
fi

echo ""
echo "╔══════════════════════════════════════════════════════════╗"
echo "║   ✅ 今日完成的核心功能                                  ║"
echo "╚══════════════════════════════════════════════════════════╝"
echo ""
echo "  1. ✅ Cell模型升级（认知层级+依赖关系+掌握标准）"
echo "  2. ✅ 数据库迁移成功（006版本）"
echo "  3. ✅ CellWrapper组件（350+行代码）"
echo "  4. ✅ 智能解锁机制"
echo "  5. ✅ 掌握度进度条"
echo "  6. ✅ 认知层级可视化"
echo "  7. ✅ 达标徽章系统"
echo ""

echo "╔══════════════════════════════════════════════════════════╗"
echo "║   🧪 功能测试清单                                        ║"
echo "╚══════════════════════════════════════════════════════════╝"
echo ""
echo "  □ 认知层级可视化（标签颜色）"
echo "  □ 掌握度进度条（0-100%显示）"
echo "  □ 智能解锁机制（前置依赖）"
echo "  □ 达标徽章动画（🏆效果）"
echo "  □ 整体视觉效果（卡片样式）"
echo ""

echo "╔══════════════════════════════════════════════════════════╗"
echo "║   📖 测试指南                                            ║"
echo "╚══════════════════════════════════════════════════════════╝"
echo ""
echo "  详细测试步骤请查看："
echo "  📄 docs/TEST_TODAY_FEATURES.md"
echo ""

echo "╔══════════════════════════════════════════════════════════╗"
echo "║   🚀 启动前端服务                                        ║"
echo "╚══════════════════════════════════════════════════════════╝"
echo ""
echo "  正在启动开发服务器..."
echo "  预计需要 10-30 秒..."
echo ""

# 进入前端目录并启动
cd frontend

echo "  💡 提示："
echo "     - 服务启动后会自动打开浏览器"
echo "     - 访问地址: http://localhost:5173"
echo "     - 登录账号: student@inspireed.com"
echo "     - 登录密码: student123"
echo ""
echo "  按 Ctrl+C 停止服务"
echo ""
echo "━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"
echo ""

# 启动开发服务器
$NPM_CMD dev

